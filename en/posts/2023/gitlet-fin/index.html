<!DOCTYPE html>
<html lang="en"><head>
<title>Notes and Thoughts on CS61B Gitlet</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=5, user-scalable=5" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="Notes and Thoughts on CS61B Gitlet" />
<meta property="og:description" content="♪(´ε｀ )" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://eimy.ink/en/posts/2023/gitlet-fin/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-07-13T00:00:00+00:00" />





<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Notes and Thoughts on CS61B Gitlet"/>
<meta name="twitter:description" content="♪(´ε｀ )"/>











  




<link rel="icon" href="http://eimy.ink/favicons/favicon.ico">



      <script src="/js/toc.js"></script>
    
    <link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">

<link rel="stylesheet" href="/scss/dark-mode.min.1b8d756f5775440d933c9656c9e438b615102519cb3d0c904c91deeaea446782.css" integrity="sha256-G411b1d1RA2TPJZWyeQ4thUQJRnLPQyQTJHe6upEZ4I=" media="screen">


<link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Material+Icons">

















<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/noto-serif-sc@5.2.8/index.css">
<link rel="stylesheet" href="/css/custom-font.css">
<link rel="stylesheet" href="/css/custom-texture.css">


</head>
<body>
    	<div id="app"><div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                <a class="a-block drawer-menu-item false" href="/en/archives/">
                    Archive
                </a>
                
            
                
                
                
                <a class="a-block drawer-menu-item false" href="/en/categories/">
                    Categories
                </a>
                
            
                
                
                
                <a class="a-block drawer-menu-item false" href="/en/tags/">
                    Tags
                </a>
                
            
                
                
                
                <a class="a-block drawer-menu-item false" href="/en/search/">
                    Search
                </a>
                
            
                
                
                
                <a class="a-block drawer-menu-item false" href="/en/about/">
                    About
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#project-overview" class="nav-project-overview">
									Project Overview
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#gitlet-version-control-mechanism" class="nav-gitlet-version-control-mechanism">
									Gitlet Version-Control Mechanism
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#user-level" class="nav-user-level">
									User Level
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#object-level" class="nav-object-level">
									Object Level
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#file-io-level" class="nav-file-io-level">
									File I/O Level
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#in-brief" class="nav-in-brief">
									In Brief
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#reflection" class="nav-reflection">
									Reflection
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#reading-order-for-the-spec" class="nav-reading-order-for-the-spec">
									Reading Order for the Spec
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#regarding-design" class="nav-regarding-design">
									Regarding Design
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#other-points" class="nav-other-points">
									Other Points
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#stats" class="nav-stats">
									Stats
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#time-and-space" class="nav-time-and-space">
									Time and Space
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#autograder-results" class="nav-autograder-results">
									Autograder Results
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#reflection-1" class="nav-reflection-1">
									Reflection
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#appendix" class="nav-appendix">
									Appendix
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#design" class="nav-design">
									Design
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#abstraction-principle" class="nav-abstraction-principle">
									Abstraction Principle
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#persistence" class="nav-persistence">
									Persistence
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="http://eimy.ink/en/">
            EIMY
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="http://eimy.ink/en/">
        <div class="single-column-header-title">EIMY</div>
        
        <div class="single-column-header-subtitle">The dots will connect.</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title">
                    Notes and Thoughts on CS61B Gitlet
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2023-07-13 00:00
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/en/categories/">[notes]</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/en/tags/course">course</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <p>Note: The passage is originally written in Chinese and translated into English via ChatGPT.</p>
<hr>
<p>Translated passage:</p>
<blockquote>
<p>Alias: Gitlet in Hindsight: Why I Suggest You Always Read the DON&rsquo;Ts Part in Spec First</p>
</blockquote>
<p>After spending a few days catching up with the renowned project Gitlet, which has a weighty 60-page spec covering everything (lol), including informative content that provides a comprehensive understanding and training on every technical foundation, from system design to integration testing. It truly deserves the highest praise for this course project in its history.</p>
<p>[Reference]: <a href="https://sp21.datastructur.es/materials/proj/proj2/proj2">UCB CS61B-21SP-Gitlet</a></p>
<h2 id="project-overview">Project Overview</h2>
<p>Gitlet is a version control system that mimics the functionality of the popular system Git and implements some of its basic commands, including <code>init</code>, <code>add</code>, <code>commit</code>, <code>rm</code>, <code>checkout</code>, <code>branch</code>, <code>reset</code>, <code>rm-branch</code>, <code>merge</code>, and more.</p>
<p>As an individual project for the course, it starts with only a few necessary <code>.java</code> classes and a few lines of code samples. The task requires designing and completing the system, object methods, data structures, and a few algorithms based on the requirements.</p>
<h2 id="gitlet-version-control-mechanism">Gitlet Version-Control Mechanism</h2>
<p>In essence, version control in Git (Gitlet) revolves around the question of &ldquo;how to save a certain version&rdquo; and &ldquo;how to switch to a specific version.&rdquo; These two questions can be understood from three levels, from top to bottom: the user level, the object level, and the file read/write level.</p>
<p>From a design perspective, there should exist an abstraction barrier between these three levels, as explained in the <a href="https://en.wikibooks.org/wiki/Object_Oriented_Programming/Abstraction_Barrier">abstraction barrier</a> concept. This means that when users issue commands, they don&rsquo;t need to know or manipulate objects, pointers, etc., and file read/write operations should not occur between objects either.</p>
<h3 id="user-level">User Level</h3>
<p>First, let&rsquo;s discuss what happens at a higher level, which is the part that users are aware of.</p>
<ul>
<li>What does Git initialization do? It creates a hidden directory called <code>.git</code> in the current working directory (CWD) and some files inside it.</li>
<li>How are file versions saved? When a <code>commit</code> is made, Git captures the current snapshot of the committed files and stores it in the <code>.git</code> directory.</li>
<li>How to switch to a specific version? When using commands like <code>checkout</code> or <code>reset</code> to switch versions, Git looks for the corresponding snapshot based on the given branch name/commit ID in the <code>.git</code> directory. It then restores the specified file or the entire directory in the CWD to match that snapshot.</li>
</ul>
<img src="./assets/image-20230713140220806.png#center" alt=".git目录" style="zoom:50%;border-radius:5px;" />
<h3 id="object-level">Object Level</h3>
<p>Now let&rsquo;s see how these steps are implemented at the object level. Gitlet simplifies the directory structure of Git to some extent, storing fewer metadata for each object, but the essence remains the same. The following diagram represents the structure of the <code>.gitlet</code> directory.</p>
<ul>
<li>Gitlet version control utilizes two types of objects: Commit and Blob.
<ul>
<li>Each Blob object corresponds to a file snapshot.</li>
<li>Each Commit object corresponds to a <code>commit</code>.</li>
</ul>
</li>
<li>How are these objects used to track file versions?
<ul>
<li>When a file is added to the staging area (<code>add [file name]</code>), a Blob object is created to store the current file content. The mapping between the file name and the corresponding Blob instance is then stored in the staging area.</li>
<li>When committing files, a Commit object is created. It retrieves the mapping relationships from the staging area and saves them in the Commit object. In addition to the index mapping, each object also records the parent Commit, timestamp, commit message, etc.</li>
<li>Example: In the diagram below, each blue square represents a Commit object. Inside each Commit object, there is a Map that records the file snapshots for the current commit. For instance, both Hello.txt in Commit 1 and Commit 2 point to Blob 0, indicating that the file content (snapshot) did not change in these two commits.</li>
</ul>
</li>
<li>How is switching to a specific version implemented? — By moving pointers
<ul>
<li>To switch the <code>HEAD</code> pointer to another branch&rsquo;s <code>branchHeadCommit</code>, at the object level, it means that the <code>HEAD</code> pointer, originally pointing to a Commit object on branchA, should now point to another Commit object <code>branchHeadCommit</code> on branchB. This can be achieved by something like <code>updatePointerToCommit(HEAD, branchHeadCommit)</code>.</li>
</ul>
</li>
</ul>
<img src="./assets/image-20230707133304171.png#center" alt=".gitlet结构" style="zoom:50%;" />
<h3 id="file-io-level">File I/O Level</h3>
<p>Finally, let&rsquo;s dive into the lower-level and examine file read/write operations. Since certain commands require storing Blob objects, Commit objects, and the current content of the staging area locally, two questions arise:</p>
<ul>
<li>
<p>How are objects stored as data (to retrieve and use them later)?</p>
<ul>
<li>
<p>Java&rsquo;s serialization is used to store objects. In Gitlet, all <strong>objects</strong> can be serialized and stored in files, including Blob, Commit, and StagingArea (if applicable). In the <code>.git</code> directory, they are stored in the <code>/objects/</code> directory.</p>
</li>
<li>
<p>On the other hand, <strong>pointers</strong> are managed through file read/write operations (without serialization). Each pointer corresponds to a file that contains the ID of the object it points to. When modifying a pointer&rsquo;s target, the actual change occurs in the file by updating the ID. In the <code>.git</code> directory, pointers are stored in the <code>.git/refs/</code> directory.</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/* Serialize a Model object */</span>
</span></span><span class="line"><span class="cl"><span class="n">Model</span> <span class="n">m</span> <span class="o">=</span> <span class="o">....;</span> <span class="c1">// Assuming Model class implements Serializable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">File</span> <span class="n">outFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">saveFileName</span><span class="o">);</span> <span class="c1">// Create a new File
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ObjectOutputStream</span> <span class="n">out</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">        <span class="k">new</span> <span class="n">ObjectOutputStream</span><span class="o">(</span><span class="k">new</span> <span class="n">FileOutputStream</span><span class="o">(</span><span class="n">outFile</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span><span class="o">.</span><span class="na">writeObject</span><span class="o">(</span><span class="n">m</span><span class="o">);</span> <span class="c1">// Write the object to the stream
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">excp</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/* Deserialize a Model object */</span>
</span></span><span class="line"><span class="cl"><span class="n">Model</span> <span class="n">m</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="n">File</span> <span class="n">inFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">saveFileName</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ObjectInputStream</span> <span class="n">inp</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">        <span class="k">new</span> <span class="n">ObjectInputStream</span><span class="o">(</span><span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="n">inFile</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">=</span> <span class="o">(</span><span class="n">Model</span><span class="o">)</span> <span class="n">inp</span><span class="o">.</span><span class="na">readObject</span><span class="o">();</span>  <span class="c1">// Cast object into the expected class
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">inp</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="o">|</span> <span class="n">ClassNotFoundException</span> <span class="n">excp</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>How to find and retrieve objects/modify pointer targets?</p>
<ul>
<li>Gitlet, like Git, uses SHA-1 (Secure Hash Algorithm 1) to generate a 160-bit hash value as the unique ID (40 hexadecimal characters) for each object. When an object is created, its ID is generated based on its content. For example, <strong>identical file contents will produce the same ID after encryption</strong>. The filenames for the stored objects are their respective IDs. This means that the ID can be used to locate the serialized objects in the directory. Furthermore, this enables <strong>content-addressable lookup</strong> based on the object&rsquo;s content.</li>
<li>Regarding object retrieval, let&rsquo;s take obtaining a Commit object as an example. The steps include: obtaining the commit ID (which should be a field of the object) -&gt; obtaining the file path based on the ID (since they are stored in a specified directory) -&gt; deserializing the file. Similarly, modifying the object involves updating its content and then serializing it back into the file.</li>
<li>As for modifying <strong>pointer</strong> targets, at the file read/write level, the operation involves: obtaining the ID of the targetCommit -&gt; writing the ID into the file corresponding to the HEAD pointer.</li>
</ul>
</li>
</ul>
<p>(Reminder to self) It&rsquo;s important to encapsulate these operations within the objects. The main logic should not contain statements like <code>commitMap.put(readContentAsString(commitPath), readContentAsString(blobPath))</code>. When reviewing others&rsquo; implementations, if you come across such mixed file read/write operations at the object level, be cautious.</p>
<h3 id="in-brief">In Brief</h3>
<p>The above passages may seem repetitive, but they provide different perspectives on version control systems. Here&rsquo;s a basic analogy:</p>
<ul>
<li>Initializing a version control system == Placing a small box in the current working directory.</li>
<li>Saving file versions == Each time a commit is made, making a copy of the submitted files and storing them in the box.</li>
<li>Switching the current directory or a file in the directory to a specific version == Finding the corresponding archive in the box and bringing it back to the current working directory (CWD).</li>
</ul>
<p>The other concepts, such as objects, pointers, encoding, etc., are methods used to optimize the copying process and speed up the retrieval of files from the box (at least that&rsquo;s how I understand it):</p>
<ul>
<li>Blob object == Archive of a single file.</li>
<li>Commit object == A note indicating which file versions to retrieve at a particular time.</li>
<li>Commit tree == An outline of the notes (commits).</li>
<li>SHA-1 encoding == Giving each file a name based on its content (useful for fast content comparison and addressing).</li>
<li>Pointers == Labels indicating which version is currently in the box.</li>
</ul>
<p>Archiving files is a straightforward process that anyone can do (think: paper_final_final_final.docx). However, I believe the essence lies in SHA-1 encoding.</p>
<h2 id="reflection">Reflection</h2>
<blockquote>
<p>Notes taken while coding, might be messy.</p>
</blockquote>
<h3 id="reading-order-for-the-spec">Reading Order for the Spec</h3>
<ul>
<li>The project specification for Gitlet is quite lengthy, making it impractical to read it all at once before starting. If I were to do it again, I would watch the videos first, skim through the command explanations and the &ldquo;avoids&rdquo; section, and then refer to the spec while coding.</li>
<li>It&rsquo;s important to pay close attention to the &ldquo;Don&rsquo;t&rdquo; sections in the spec. The reason they are mentioned is that people tend to make those mistakes. For example, using a HashMap as the default Map implementation and encountering a Heisenbug. In reality, a TreeMap should be used to maintain order. ← Starts with &ldquo;callback&rdquo;.</li>
</ul>
<h3 id="regarding-design">Regarding Design</h3>
<ul>
<li>
<p>Initially, it&rsquo;s crucial to read the entire spec comprehensively, understanding the roles of each object and their commonly used interaction methods. Once the design is clear, implementation can begin.</p>
<p>Positive example: When implementing the <code>&lt;branch&gt;</code> command, a major directory overhaul was planned. However, due to a well-designed abstraction earlier, only a single line needed to be added to the File directory without any other changes.</p>
</li>
<li>
<p>Protect the abstraction barrier. Interactions between higher-level objects should avoid using lower-level operations.</p>
<p>Negative example: Initially, hashing and serialization were done directly in the main logic, leading to a lot of refactoring during the encapsulation process.</p>
</li>
<li>
<p>Naming is crucial. After some painful lessons, the following points are summarized:</p>
<ul>
<li>Uniformity: Just like joining database tables, if objects need to communicate, they must have some common names. A negative example would be what I did initially, using different names for the IDs obtained from sha-1 hashing, such as shaName, shaId, hashName, etc.</li>
<li>Intuitiveness: Variable names should be as specific as possible. For example, &ldquo;map&rdquo; can be written as &ldquo;keyToVal,&rdquo; making it easier to understand.</li>
<li>Generality: Methods should not be overly specific so that they can be easily recalled when used elsewhere. For example, instead of using &ldquo;getHead&rdquo; and &ldquo;getMaster,&rdquo; it is better to use &ldquo;getCommit&rdquo; and &ldquo;getPointer.&rdquo;</li>
</ul>
</li>
</ul>
<h3 id="other-points">Other Points</h3>
<ul>
<li>It would be beneficial to read the source code of Git to find better practices, although the specification alone is generally sufficient.</li>
</ul>
<h2 id="stats">Stats</h2>
<h3 id="time-and-space">Time and Space</h3>
<p>The code consists of approximately 1,000 lines. In terms of time, it took around 4.5 days to complete, with a recorded duration of around 40 hours according to Wakatime. Although I spent more than 10 hours debugging during that time (oops!). I remember Josh sharing some data in class, and most students took around 30-40 hours to complete the project.</p>
<p>From a statistical standpoint, Gitlet is not a large-scale project. However, considering that it requires independent completion and involves design, unit and integration testing, makefile, Java file I/O, algorithms, encoding, and even training on Git itself, it is still a highly rewarding experience.</p>
<img src="./assets/image-20230712171416829.png#center" alt="code stats" style="zoom:50%;" />
<h3 id="autograder-results">Autograder Results</h3>
<p>All functional tests passed successfully. The Extra-Credit tests failed, as well as the style check (mainly due to naming, which I&rsquo;ll improve next time). However, I believe those failures don&rsquo;t significantly impact the overall outcome, so I didn&rsquo;t continue the autograder-oriented programming.</p>
<p>BTW, reasons for not implementing Extra-Credit features:</p>
<ol>
<li>Towards the end, many commands were combinations of previous commands, resulting in diminishing returns.</li>
<li>The &ldquo;remote&rdquo; command in Gitlet differs greatly from Git and may not contribute much to understanding the underlying logic of Git.</li>
<li>After encountering a Heisenbug, my energy was depleted.</li>
</ol>
<p>Despite not pursuing the Extra-Credit tasks, I still found the Gitlet project rewarding and a valuable learning experience.</p>
<img src="./assets/image-20230712170907514.png#center" alt="Autograder: passed all functional tests" style="zoom:50%;" />
<h2 id="reflection-1">Reflection</h2>
<p>Gitlet is an impressive project in the world of renowned universities. As I mentioned at the beginning, I firmly believe that most individuals with a similar level of proficiency can gain a lot from this project. Just take a glance at the spec, and you&rsquo;ll understand.</p>
<p>Speaking from a technical standpoint, I&rsquo;m not qualified to say much as I consider myself a novice. So, let me conclude with a few remarks. In one of Josh&rsquo;s lectures, he shared the results of a Gitlet survey, and one particular detail stuck with me. Some students spent over 50 hours on this project (which, in my personal experience, far exceeds the workload of a typical course assignment in the freshman year). However, only a few individuals gave negative feedback in the end, and I recall Josh expressing his apologies for that. This indirectly reflects the worthwhileness of &ldquo;The Gitlet Grind.&rdquo;</p>
<p>An official end of CS61B &ndash; so grateful for the open-source materials! Time to move on and continue working on something else.</p>
<h2 id="appendix">Appendix</h2>
<blockquote>
<p>The following is an excerpt from the README I wrote, explaining the design aspects of my Gitlet implementation.</p>
</blockquote>
<h3 id="design">Design</h3>
<h4 id="abstraction-principle">Abstraction Principle</h4>
<ul>
<li>
<p>An issue with version control systems:</p>
<p>Requires cumbersome operations like hashing, serialization, map operations, directory concatenation, file I/O, etc.</p>
</li>
<li>
<p>Solution:</p>
<ul>
<li>On a higher level, involve only communications between objects (between Blob and Commit, there should only be <code>Blob b = commit1.get(filename)</code>)</li>
<li>Eliminate the need to dive into low-level operations through encapsulation.
i.e. Outside the class of that object, never try to hash things, or modify maps inside Commit/Blob objects.
E.g. The <code>StagingArea</code> supports common map operations. Upon put (fileName, Commit), it completes: read commit into commit id -&gt; put into its map -&gt; serialize itself and write into the file for staging.</li>
</ul>
</li>
</ul>
<h4 id="persistence">Persistence</h4>
<p>The directory structure looks like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">CWD
</span></span><span class="line"><span class="cl"> └──.gitlet
</span></span><span class="line"><span class="cl">     └── --commits/       <span class="c1"># all commits</span>
</span></span><span class="line"><span class="cl">        ├──blobs/         <span class="c1"># file content</span>
</span></span><span class="line"><span class="cl">        ├──branchHeads/   <span class="c1"># branch heads</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span>  └──--master      <span class="c1"># master branch</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span>    ├──..	      <span class="c1"># other branches</span>
</span></span><span class="line"><span class="cl">        ├──HEAD	          <span class="c1"># HEAD commit</span>
</span></span><span class="line"><span class="cl">        ├──add            <span class="c1"># staging area for addition</span>
</span></span><span class="line"><span class="cl">        └──rm             <span class="c1"># staging area for removal</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The <code>Main</code> class is the entry class of the project. It is responsible for calling different functions according to given commands.</p>
<p>The <code>Repository</code> class will set up all persistance. It will</p>
<ol>
<li>Create and initialize files and directories in the <code>.gitlet</code> folder if the directory does not exist;</li>
<li>Handle all updates of <code>HEAD</code> , <code>master</code>, <code>branchHeads</code> and the serialization of two StagingAreas <code>add</code> and <code>rm</code>.</li>
<li>Execute the commands / function calls from <code>Main</code>.</li>
</ol>
<p>The <code>Commit</code> class handles the serialization of <code>Commit</code> objects. It also deals with conversion between commit ids and commit objects. Each <code>Commit</code> records mappings of held file names and their corresponding file content. Specifically, it fulfil the following purposes:</p>
<ol>
<li>Constructs Commit objects;</li>
<li>Serializes and saves Commit objects to the .gitlet/commits directory;</li>
<li>Given a commit id, retrieves the corresponding Commit object.</li>
</ol>
<p>The <code>Blob</code> class handles the serialization of <code>Blob</code> objects. A blob is a snapshot of a file&rsquo;s content at the moment of addition. For instance, a file named &ldquo;hello.txt&rdquo; can refer to different <code>Blobs</code> in different <code>Commits</code>.</p>
<p>Its functions are similar to <code>Commit</code>, namely object construction, serialization and retrieval.</p>
<p>The <code>StagingArea</code> class stores files for addition and removal. A StagingArea works like a Java Map, stores mappings of file plain names to their blob ids, and supports basic map operations (<code>remove</code>, <code>get</code>, <code>put</code>). <code>add</code> and <code>rm</code> are <code>StagingAreas</code> for staged addition and removal respectively.</p>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">Last modified on 2023-07-13</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="/en/posts/2023/aws-amplify/">
			Next<br>Deploying an App via AWS Amplify
                </a>
                
                
                
                <a class="older-posts" href="/en/posts/2023/b-tree-llrb/">
			Previous<br>61B Notes - B-Trees &amp; LLRB
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                












<script src="https://giscus.app/client.js"
        data-repo=""
        data-repo-id=""
        data-category=""
        data-category-id=""
        data-mapping=""
        data-strict=""
        data-reactions-enabled=""
        data-emit-metadata=""
        data-input-position=""
        data-theme=""
        data-lang=""
        crossorigin=""
        async>
</script>

            </div>
        </div>
    </div>


                    </div>
            </div><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="http://eimy.ink/en/">
    
        <div class="nav-title">
            EIMY
        </div>
        
        <div class="nav-subtitle">
            The dots will connect.
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
            <a class="a-block nav-link-item false" href="/en/archives/">
                Archive
            </a>
            
        
            
            
            
            <a class="a-block nav-link-item false" href="/en/categories/">
                Categories
            </a>
            
        
            
            
            
            <a class="a-block nav-link-item false" href="/en/tags/">
                Tags
            </a>
            
        
            
            
            
            <a class="a-block nav-link-item false" href="/en/search/">
                Search
            </a>
            
        
            
            
            
            <a class="a-block nav-link-item false" href="/en/about/">
                About
            </a>
            
        
    </div>

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	2026 EIMY
	

    </div>
</div>
<div id="extraContainer" class="extra-container">
    <div class="toc-wrapper">
        

        
        <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#project-overview" class="nav-project-overview">
									Project Overview
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#gitlet-version-control-mechanism" class="nav-gitlet-version-control-mechanism">
									Gitlet Version-Control Mechanism
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#user-level" class="nav-user-level">
									User Level
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#object-level" class="nav-object-level">
									Object Level
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#file-io-level" class="nav-file-io-level">
									File I/O Level
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#in-brief" class="nav-in-brief">
									In Brief
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#reflection" class="nav-reflection">
									Reflection
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#reading-order-for-the-spec" class="nav-reading-order-for-the-spec">
									Reading Order for the Spec
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#regarding-design" class="nav-regarding-design">
									Regarding Design
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#other-points" class="nav-other-points">
									Other Points
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#stats" class="nav-stats">
									Stats
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#time-and-space" class="nav-time-and-space">
									Time and Space
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#autograder-results" class="nav-autograder-results">
									Autograder Results
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#reflection-1" class="nav-reflection-1">
									Reflection
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#appendix" class="nav-appendix">
									Appendix
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#design" class="nav-design">
									Design
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#abstraction-principle" class="nav-abstraction-principle">
									Abstraction Principle
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#persistence" class="nav-persistence">
									Persistence
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
        
    </div>
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top"
            :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>

<div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	2026 EIMY
	
</div>
            </div>
    
    <script src="/js/journal.js"></script></body>
</html>
